import std.*;

// FFI STRUCTURES DECLARATION
FFIStruct.addStruct("ExtS");
FFIStruct.addMember("ExtS", "x", "i");
FFIStruct.addMember("ExtS", "z", "i");
FFIStruct.addMember("ExtS", "y", "d");


// FFI STRUCTURE CREATION
var s = FFIStruct.new("ExtS");


s.setMember("x", 1);
s.setMember("y", 3.123);
s.setMember("z", 2);


println(s.getMember("x"));
println(s.getMember("y"));
println(s.getMember("z"));

var h =  FFILib.new("nffi");

// FFI CALL

h.call("setC", "v", s, 1111, 33.323123, 22);


println("1 =============");
var x = h.call("getCX", "i", s);
println("2 =============");
var y = h.call("getCY", "d", s);
println("3 =============");
var z = h.call("getCZ", "i", s);
println("4 =============");
println(x, y, z);
println("5 =============");

println(s.getMember("x"));
println(s.getMember("y"));
println(s.getMember("z"));

